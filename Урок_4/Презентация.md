# Настройка на IAM потребители и роли

---

## Какво ще научим днес?

- Какво е IAM и защо е важен за сигурността
- Как да създаваме и управляваме IAM потребители
- Какво са IAM роли и политики
- Как да настроим AWS CLI с IAM credentials

---

## Какво е IAM?

![IAM](https://i.imgur.com/1XZtVnL.png)

AWS Identity and Access Management (IAM) е услуга, която ви помага да контролирате сигурно достъпа до AWS ресурси

---

## Ключови компоненти на IAM

- **Потребители (Users)** - индивидуални акаунти
- **Групи (Groups)** - колекции от потребители
- **Роли (Roles)** - набор от разрешения за услуги или приложения
- **Политики (Policies)** - документи, дефиниращи разрешенията
- **Идентичности (Identities)** - ресурси, на които могат да бъдат прикрепени политики

---

## Защо IAM е важен?

![Сигурност](https://i.imgur.com/2XZtVnL.png)

1. **Сигурност** - принцип на най-малките привилегии
2. **Контрол на достъпа** - фино управление
3. **Одит** - проследяване на действията
4. **Интеграция** - работи с всички AWS услуги
5. **Безплатен** - включен във всеки AWS акаунт

---

## Най-добри практики за IAM

1. **Не използвайте Root акаунта** за ежедневни задачи
2. **Създавайте индивидуални потребители**
3. **Използвайте групи** за управление на разрешения
4. **Прилагайте силни пароли**
5. **Активирайте MFA**
6. **Използвайте роли** за делегиране на разрешения
7. **Прилагайте принципа на най-малките привилегии**

---

## Създаване на IAM потребител

![Създаване на потребител](https://i.imgur.com/3XZtVnL.png)

1. Отидете на услугата "IAM"
2. Кликнете "Users" → "Add users"
3. Въведете име на потребителя
4. Изберете типа на достъпа:
   - **AWS Management Console access**
   - **Programmatic access**

---

## Задаване на разрешения

![Разрешения](https://i.imgur.com/4XZtVnL.png)

Три опции:
1. **Add user to group**
2. **Copy permissions from existing user**
3. **Attach existing policies directly**

---

## Преглед и създаване

![Преглед](https://i.imgur.com/5XZtVnL.png)

**Важно**: Ако сте създали програмен достъп, запазете Access key ID и Secret access key. Това е единственият път, когато можете да видите Secret access key!

---

## Управление на съществуващи потребители

- **Промяна на разрешения**
- **Промяна на парола**
- **Деактивиране/Изтриване на потребител**

---

## IAM групи

![Групи](https://i.imgur.com/6XZtVnL.png)

IAM групите са колекции от IAM потребители с общи разрешения

---

## Създаване на IAM група

1. Кликнете "User groups" → "Create group"
2. Въведете име на групата
3. Изберете политики
4. Кликнете "Create group"

---

## Управление на групи

- **Добавяне на потребители към група**
- **Премахване на потребители от група**
- **Промяна на политики на група**

---

## IAM политики

![Политики](https://i.imgur.com/7XZtVnL.png)

IAM политиките са JSON документи, които дефинират разрешенията

---

## Типове политики

1. **AWS управлявани политики**
2. **Политики, управлявани от клиента**
3. **Вградени политики**

---

## Структура на IAM политика

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:ListBucket",
      "Resource": "arn:aws:s3:::example-bucket"
    }
  ]
}
```

---

## Основни елементи на политика

- **Version** - версия на езика на политиката
- **Statement** - масив от отделни изявления
- **Effect** - "Allow" или "Deny"
- **Action** - действия, които се разрешават или забраняват
- **Resource** - ресурси, за които се прилага изявлението
- **Condition** (опционално) - условия за прилагане

---

## Създаване на персонализирана политика

![Създаване на политика](https://i.imgur.com/8XZtVnL.png)

1. Кликнете "Policies" → "Create policy"
2. Изберете метод: Visual editor или JSON
3. Конфигурирайте разрешенията
4. Добавете тагове (опционално)
5. Въведете име и описание

---

## IAM роли

![Роли](https://i.imgur.com/9XZtVnL.png)

IAM ролите са набор от разрешения, които могат да бъдат поети от потребители, приложения или AWS услуги

---

## Кога да използваме роли?

1. **Делегиране на достъп между акаунти**
2. **Достъп за AWS услуги**
3. **Достъп за приложения на EC2 инстанции**
4. **Федерация на идентичности**

---

## Създаване на IAM роля

![Създаване на роля](https://i.imgur.com/0XZtVnL.png)

1. Кликнете "Roles" → "Create role"
2. Изберете тип на доверено лице
3. Конфигурирайте доверието
4. Изберете политики
5. Добавете тагове (опционално)
6. Въведете име и описание

---

## AWS CLI

![AWS CLI](https://i.imgur.com/1XZtVnL.png)

AWS Command Line Interface (CLI) е инструмент за управление на AWS услуги от командния ред

---

## Инсталиране на AWS CLI

### За Windows
- Изтеглете инсталационния файл от официалния сайт
- Следвайте инструкциите за инсталация

### За macOS
- `brew install awscli`

### За Linux
- Ubuntu/Debian: `sudo apt-get install awscli`
- Amazon Linux/RHEL/CentOS: `sudo yum install awscli`

---

## Конфигуриране на AWS CLI

```bash
aws configure
```

Въведете:
- AWS Access Key ID
- AWS Secret Access Key
- Default region name (например eu-central-1)
- Default output format (например json)

---

## Получаване на Access Keys

![Access Keys](https://i.imgur.com/2XZtVnL.png)

1. В IAM конзолата, изберете потребителя
2. Отидете на "Security credentials"
3. Кликнете "Create access key"
4. Запазете ключовете (единствен шанс!)

---

## Тестване на AWS CLI

```bash
# Списък на всички S3 buckets
aws s3 ls

# Информация за текущия потребител
aws sts get-caller-identity

# Списък на EC2 инстанции
aws ec2 describe-instances
```

---

## Управление на множество профили

```bash
# Създаване на нов профил
aws configure --profile profilename

# Използване на конкретен профил
aws s3 ls --profile profilename

# Задаване на профил по подразбиране
export AWS_PROFILE=profilename  # Linux/macOS
set AWS_PROFILE=profilename     # Windows
```

---

## Практическа задача

1. Създайте IAM потребител с име "Developer"
2. Създайте IAM група "Developers"
3. Създайте персонализирана политика
4. Създайте IAM роля за EC2
5. Настройте AWS CLI

---

## Въпроси?

![Въпроси](https://i.imgur.com/3XZtVnL.png)
